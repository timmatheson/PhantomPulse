function PerGrpRateValve(timespan, maxCount, grpProp{
  this.timespan = timespan;
  this.maxAmount = maxCount;
  this.grpProp = grpProp;
  this.inSpanAmounts = {};
  var me = this;
  this.hInterval = setInterval(function(){
    me.inSpanAmounts = {};
  }, timespan);
}
PerGrpRateValve.prototype.check = function(option){
  var inSpanAmount = this.inSpanAmounts[option[this.grpProp]] || 0;
  return inSpanAmount < this.maxAmount;
}
PerGrpRateValve.prototype.count = function(option){
  var grp = option[this.grpProp];
  this.inSpanAmounts[grp] = (this.inSpanAmounts[grp] || 0) + 1;
}

exports.class = PerGrpRateValve;