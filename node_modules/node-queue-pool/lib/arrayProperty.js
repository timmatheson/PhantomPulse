/**
 * Created with JetBrains WebStorm.
 * User: kaven276
 * Date: 12-10-23
 * Time: 下午2:13
 */
function $(obj){
  return new Core(obj)
}

function Core(obj){
  this.obj = obj;
}

Core.prototype.addToArrayProp = function(propName, item){
  var obj = this.obj
    , arr = obj[propName]
    ;
  if (arr) {
    arr.push(item);
  } else {
    obj[propName] = [item];
  }
  return this;
}

Core.prototype.removeFromArrayProp = function(propName, item){
  var obj = this.obj
    , arr = obj[propName]
    , index = arr.indexOf(item)
    ;
  arr.splice(index, 1);
  if (arr.length === 0) {
    delete obj[propName];
  }
  return this;
}

var a = {};

$(a).addToArrayProp('sockets', 's1').addToArrayProp('sockets', 's2');
console.log(a);
$(a).removeFromArrayProp('sockets', 's1').removeFromArrayProp('sockets', 's2');
console.log(a);

var $a = $(a);
$a.addToArrayProp('sockets', 's1').addToArrayProp('sockets', 's2');
console.log(a);
$a.removeFromArrayProp('sockets', 's1').removeFromArrayProp('sockets', 's2');
console.log(a);

a.wrapper = $(a);

var http = require('http');
var a = require('./ActionQueue.js');
console.log(require.cache);